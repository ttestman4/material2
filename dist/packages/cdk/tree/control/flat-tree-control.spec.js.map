{"version":3,"file":"flat-tree-control.spec.js","sourceRoot":"","sources":["../../../../../src/cdk/tree/control/flat-tree-control.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import {FlatTreeControl} from './flat-tree-control';\n\ndescribe('CdkFlatTreeControl', () => {\n  let treeControl: FlatTreeControl<TestData>;\n  let getLevel = (node: TestData) => node.level;\n  let isExpandable = (node: TestData) => node.children && node.children.length > 0;\n\n  beforeEach(() => {\n    treeControl = new FlatTreeControl<TestData>(getLevel, isExpandable);\n  });\n\n  describe('base tree control actions', () => {\n    it('should be able to expand and collapse dataNodes', () => {\n      const nodes = generateData(10, 4);\n      const secondNode = nodes[1];\n      const sixthNode = nodes[5];\n      treeControl.dataNodes = nodes;\n\n      treeControl.expand(secondNode);\n\n\n      expect(treeControl.isExpanded(secondNode))\n          .toBeTruthy('Expect second node to be expanded');\n      expect(treeControl.expansionModel.selected)\n          .toContain(secondNode, 'Expect second node in expansionModel');\n      expect(treeControl.expansionModel.selected.length)\n          .toBe(1, 'Expect only second node in expansionModel');\n\n      treeControl.toggle(sixthNode);\n\n      expect(treeControl.isExpanded(secondNode))\n          .toBeTruthy('Expect second node to stay expanded');\n      expect(treeControl.isExpanded(sixthNode))\n          .toBeTruthy('Expect sixth node to be expanded');\n      expect(treeControl.expansionModel.selected)\n          .toContain(sixthNode, 'Expect sixth node in expansionModel');\n      expect(treeControl.expansionModel.selected)\n          .toContain(secondNode, 'Expect second node in expansionModel');\n      expect(treeControl.expansionModel.selected.length)\n          .toBe(2, 'Expect two dataNodes in expansionModel');\n\n      treeControl.collapse(secondNode);\n\n      expect(treeControl.isExpanded(secondNode))\n          .toBeFalsy('Expect second node to be collapsed');\n      expect(treeControl.expansionModel.selected.length)\n          .toBe(1, 'Expect one node in expansionModel');\n      expect(treeControl.isExpanded(sixthNode)).toBeTruthy('Expect sixth node to stay expanded');\n      expect(treeControl.expansionModel.selected)\n          .toContain(sixthNode, 'Expect sixth node in expansionModel');\n    });\n\n    it('should return correct expandable values', () => {\n      const nodes = generateData(10, 4);\n      treeControl.dataNodes = nodes;\n\n      for (let i = 0; i < 10; i++) {\n        expect(treeControl.isExpandable(nodes[i]))\n          .toBeTruthy(`Expect node[${i}] to be expandable`);\n\n        for (let j = 0; j < 4; j++) {\n          expect(treeControl.isExpandable(nodes[i].children[j]))\n            .toBeFalsy(`Expect node[${i}]'s child[${j}] to be not expandable`);\n        }\n      }\n    });\n\n    it('should return correct levels', () => {\n      const numNodes = 10;\n      const numChildren = 4;\n      const numGrandChildren = 2;\n      const nodes = generateData(numNodes, numChildren, numGrandChildren);\n      treeControl.dataNodes = nodes;\n\n      for (let i = 0; i < numNodes; i++) {\n        expect(treeControl.getLevel(nodes[i]))\n          .toBe(1, `Expec node[${i}]'s level to be 1`);\n\n        for (let j = 0; j < numChildren; j++) {\n          expect(treeControl.getLevel(nodes[i].children[j]))\n            .toBe(2, `Expect node[${i}]'s child[${j}] to be not expandable`);\n\n          for (let k = 0; k < numGrandChildren; k++) {\n            expect(treeControl.getLevel(nodes[i].children[j].children[k]))\n              .toBe(3, `Expect node[${i}]'s child[${j}] to be not expandable`);\n          }\n        }\n      }\n    });\n\n    it('should toggle descendants correctly', () => {\n      const numNodes = 10;\n      const numChildren = 4;\n      const numGrandChildren = 2;\n      const nodes = generateData(numNodes, numChildren, numGrandChildren);\n      const data: TestData[] = [];\n      flatten(nodes, data);\n      treeControl.dataNodes = data;\n\n      treeControl.expandDescendants(nodes[1]);\n\n      const expandedNodesNum = 1 + numChildren + numChildren * numGrandChildren;\n      expect(treeControl.expansionModel.selected.length)\n          .toBe(expandedNodesNum, `Expect expanded ${expandedNodesNum} nodes`);\n\n      expect(treeControl.isExpanded(nodes[1])).toBeTruthy('Expect second node to be expanded');\n      for (let i = 0; i < numChildren; i++) {\n\n        expect(treeControl.isExpanded(nodes[1].children[i]))\n          .toBeTruthy(`Expect second node's children to be expanded`);\n        for (let j = 0; j < numGrandChildren; j++) {\n          expect(treeControl.isExpanded(nodes[1].children[i].children[j]))\n              .toBeTruthy(`Expect second node grand children to be not expanded`);\n        }\n      }\n\n    });\n\n    it('should be able to expand/collapse all the dataNodes', () => {\n      const numNodes = 10;\n      const numChildren = 4;\n      const numGrandChildren = 2;\n      const nodes = generateData(numNodes, numChildren, numGrandChildren);\n      const data: TestData[] = [];\n      flatten(nodes, data);\n      treeControl.dataNodes = data;\n\n      treeControl.expandDescendants(nodes[1]);\n\n      treeControl.collapseAll();\n\n      expect(treeControl.expansionModel.selected.length).toBe(0, `Expect no expanded nodes`);\n\n      treeControl.expandAll();\n\n      const totalNumber = numNodes + numNodes * numChildren\n          + numNodes * numChildren * numGrandChildren;\n      expect(treeControl.expansionModel.selected.length)\n        .toBe(totalNumber, `Expect ${totalNumber} expanded nodes`);\n    });\n  });\n});\n\nexport class TestData {\n  a: string;\n  b: string;\n  c: string;\n  level: number;\n  children: TestData[];\n\n  constructor(a: string, b: string, c: string, level: number = 1, children: TestData[] = []) {\n    this.a = a;\n    this.b = b;\n    this.c = c;\n    this.level = level;\n    this.children = children;\n  }\n}\n\nfunction generateData(dataLength: number, childLength: number, grandChildLength: number = 0)\n    : TestData[] {\n  let data = <any>[];\n  let nextIndex = 0;\n  for (let i = 0; i < dataLength; i++) {\n    let children = <any>[];\n    for (let j = 0; j < childLength; j++) {\n      let grandChildren = <any>[];\n      for (let k = 0; k < grandChildLength; k++) {\n        grandChildren.push(new TestData(`a_${nextIndex}`, `b_${nextIndex}`, `c_${nextIndex++}`, 3));\n      }\n      children.push(\n          new TestData(`a_${nextIndex}`, `b_${nextIndex}`, `c_${nextIndex++}`, 2, grandChildren));\n    }\n    data.push(new TestData(`a_${nextIndex}`, `b_${nextIndex}`, `c_${nextIndex++}`, 1, children));\n  }\n  return data;\n}\n\nfunction flatten(nodes: TestData[], data: TestData[]) {\n  for (let node of nodes) {\n    data.push(node);\n\n    if (node.children && node.children.length > 0) {\n      flatten(node.children, data);\n    }\n  }\n}\n"]}